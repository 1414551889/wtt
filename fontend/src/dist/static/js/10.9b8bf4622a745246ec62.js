webpackJsonp([10],{EVVf:function(e,t,a){"use strict";function r(e){a("yUAZ")}Object.defineProperty(t,"__esModule",{value:!0});var n=a("lC5x"),o=a.n(n),i=a("J0Oq"),s=a.n(i),c=a("3cXf"),l=a.n(c),u=a("a3Yh"),d=a.n(u),f=a("0jG4"),m=a("0xDb"),h=(a("aiqZ"),a("L7Pj"),{name:"manage_modify",data:function(){var e;return e={vertical:"",data1:[],options3:{disabledDate:function(e){return e&&e.valueOf()<Date.now()-864e5}},model1:"",centerId:"1",daterange:"",imgName:"",single:!1,defaultList:[]},d()(e,"imgName",""),d()(e,"visible",!1),d()(e,"uploadList",[]),d()(e,"formData",{name:"",account:"",roleId:"",organizationId:""}),d()(e,"pageIndex",1),d()(e,"pageSize",10),d()(e,"formRule",{name:{required:!0,message:"请填写账号！",trigger:"blur"},account:{required:!0,message:"请填写账号！",trigger:"blur"},organizationId:{required:!0,message:"请填写所属Id！",trigger:"change"},roleId:{required:!0,message:"请选择用户角色！",trigger:"blur"}}),d()(e,"data1",[]),e},computed:{user:function(){return this.$store.state.user},editor:function(){return this.$refs.myTextEditor.quillEditor}},watch:{},created:function(){this.queryUserPermissionBycontent(),this.manage(),this.initDat()},mounted:function(){},methods:{a:function(e){var t=this.$refs.tree4.getSelectedNodes();l()(t);this.formData.organizationId=t[0].id,console.log(this.formData.organizationId)},manage:function(){var e=this;return s()(o.a.mark(function t(){var a,r,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f.a.userManage.findAll();case 3:for(a=t.sent,e.data1=a,e.data1.expand=!0,r=0;r<a.children.length;r++)if(e.data1.children[r].expand=!0,a.children[r].children)for(n=0;n<a.children[r].children.length;n++)e.data1.children[r].children[n].expand=!0;e.data1=[e.data1],e.data1.forEach(function(t){t.children.forEach(function(t){t.id===e.formData.organizationId&&(t.selected=!0)})}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),e.$Message.error(t.t0.message);case 14:case"end":return t.stop()}},t,e,[[0,11]])}))()},queryUserPermissionBycontent:function(){var e=this;return s()(o.a.mark(function t(){var a,r,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$route.query.name,t.prev=1,r={content:a},t.next=5,f.a.userManage.queryUserPermissionBycontent(r);case 5:n=t.sent,e.formData=n[0],e.formData.organizationId=n[0].centerId,e.formData.roleId=n[0].roles.id,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.$Message.error(t.t0.message);case 14:case"end":return t.stop()}},t,e,[[1,11]])}))()},initDat:function(e){var t=this;return s()(o.a.mark(function e(){var a,r,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=m.a.localStorage.getToken(),e.prev=1,r={pageIndex:t.pageIndex,pageSize:t.pageSize,jwtToken:a},e.next=5,f.a.userManage.queryRoleListing(r);case 5:n=e.sent,t.total=n.reultAllCount,t.model1=n.list,console.log(t.model1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.$Message.error(e.t0.message);case 14:case"end":return e.stop()}},e,t,[[1,11]])}))()},addUserPermission:function(){var e=this;return s()(o.a.mark(function t(){var a,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.formData,t.next=4,f.a.userManage.updateUserPermission(a);case 4:r=t.sent,e.$router.go(-1),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e.$Message.error(t.t0.message);case 11:case"end":return t.stop()}},t,e,[[0,8]])}))()},initData:function(){this.user&&(this.formData.centerId=this.user.centerId)},submit:function(){var e=this;console.log(formData),this.$refs.form.validate(function(){var t=s()(o.a.mark(function t(a){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=9;break}return r=formData,alert(formData),t.next=5,f.a.userManage.addUserPermissions(r);case 5:e.$Message.success("保存成功！"),e.$router.go(-1),t.next=10;break;case 9:e.$Message.error("验证失败");case 10:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}())},setDefaultRisk:function(){0===this.formData.isRisk&&(this.formData.riskSituation="无")},setDefaultleaser:function(){""!==this.formData.leaders&&(this.single=!0)},handleChange:function(e){this.formData.selecttime=e?new Date(e):""},dateChangea:function(e){this.formData.timeLimit=e?new Date(e):""},handleView:function(e){this.imgName=e,this.visible=!0},handleRemove:function(e){var t=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(t.indexOf(e),1)},handleSuccess:function(e,t){t.url=e.data,console.log("----"+e.data),this.formData.picture=e.data,console.log(this.formData.picture)},handleFormatError:function(e){this.$Notice.warning({title:"The file format is incorrect",desc:"File format of "+e.name+" is incorrect, please select jpg or png."})},handleMaxSize:function(e){this.$Notice.warning({title:"Exceeding file size limit",desc:"File  "+e.name+" is too large, no more than 2M."})},handleBeforeUpload:function(){var e=this.uploadList.length<1;return e||this.$Notice.warning({title:"Up to one pictures can be uploaded."}),e}}}),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"ui-toolbar"},[a("Button",{attrs:{type:"default",icon:"ios-arrow-back"},on:{click:function(t){e.$router.go(-1)}}},[e._v("返回")]),e._v(" "),a("Button",{attrs:{type:"primary",icon:"folder"},on:{click:e.addUserPermission}},[e._v("保存")])],1),e._v(" "),a("Row",[a("Col",{attrs:{span:"12",offset:"6"}},[a("Form",{ref:"form",attrs:{model:e.formData,rules:e.formRule,"label-width":100}},[a("FormItem",{attrs:{label:"姓名：",prop:"name"}},[a("Input",{attrs:{placeholder:"请输入用户姓名"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),a("FormItem",{attrs:{label:"用户账号：",prop:"account"}},[a("Input",{attrs:{placeholder:"请输入手机号(账号)"},model:{value:e.formData.account,callback:function(t){e.$set(e.formData,"account",t)},expression:"formData.account"}})],1),e._v(" "),a("FormItem",{attrs:{label:"组织结构：",prop:"organizationId"}},[a("div",{staticStyle:{height:"366px","overflow-y":"scroll"}},[[a("Tree",{ref:"tree4",attrs:{data:e.data1},on:{"on-select-change":function(t){e.a()}}})]],2)]),e._v(" "),a("FormItem",{attrs:{label:"角色：",prop:"roleId"}},[[a("Select",{staticStyle:{width:"200px"},model:{value:e.formData.roleId,callback:function(t){e.$set(e.formData,"roleId",t)},expression:"formData.roleId"}},e._l(e.model1,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.roleName))])}))]],2)],1)],1)],1)],1)},g=[],v={render:p,staticRenderFns:g},D=v,x=a("C7Lr"),b=r,I=x(h,D,!1,b,"data-v-29c6d7bf",null);t.default=I.exports},yUAZ:function(e,t){}});