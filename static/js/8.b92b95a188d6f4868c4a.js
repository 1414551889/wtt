webpackJsonp([8],{"9eIX":function(e,t){},MskC:function(e,t,n){"use strict";function a(e){n("9eIX")}Object.defineProperty(t,"__esModule",{value:!0});var r=n("lC5x"),i=n.n(r),s=n("J0Oq"),o=n.n(s),c=n("0xDb"),l=n("0jG4"),u=(n("2sCs"),function(){var e=new Date;return e.setMonth(e.getMonth()-1),e}),d={data:function(){var e=this;return{loading:!1,daterange:[],options:{disabledDate:function(e){return e&&e.getTime()>Date.now()},date:u()},columns:[{title:"标题",key:"title"},{title:"截止时间",key:"subTime",width:200,align:"center",render:function(e,t){var n=t.row.subTime;if(n)return n.substring(0,10)}},{title:"状态",key:"isCheck",width:200,align:"center",render:function(e,t){var n=t.row.isCheck,a="";switch(n){case 0:a="草稿";break;case 1:a="提交";break;case 2:a="发布";break;case 3:a="已阅";break;default:a=""}return a}},{title:"操作",width:140,render:function(t,n){var a=c.a.localStorage.getUser(),r=t("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){console.log(n.row.id),e.$router.push({name:"traceView",query:{id:n.row.id}})}}},"查看"),s=t("Button",{props:{type:"warning",size:"small"},on:{click:function(){console.log(n.row.id),e.$router.push({name:"traceEdit",query:{id:n.row.id}})}}},"编辑"),u=t("Button",{props:{type:"success",size:"small"},on:{click:function(){var t={title:"发布",content:"确定要发布「 "+n.row.title+" 」吗?",width:350,onOk:function(){function e(){return t.apply(this,arguments)}var t=o()(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=n.row.id,console.log("onlineBillId = "+t),e.next=5,l.a.trace.publishOnlineTraceBill({onlineBillId:t});case 5:this.$Message.success("发布成功！"),n.row.isCheck=2,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),this.$Message.error("操作失败!");case 12:case"end":return e.stop()}},e,this,[[0,9]])}));return e}()};e.$Modal.confirm(t)}}},"发布");return 0!==n.row.isCheck?t("div",[r]):1===a.role?t("div",[r,s]):2===a.role?t("div",[r,u]):void 0}}],tableData:[],total:0,pageIndex:1,pageSize:10}},created:function(){this.getOnlineTraceBills()},computed:{user:function(){return this.$store.state.user}},methods:{search:function(){this.getOnlineTraceBills(1)},getOnlineTraceBills:function(e){var t=this;return o()(i.a.mark(function n(){var a,r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e&&(t.pageIndex=e),n.prev=1,a={daterange:t.daterange,pageIndex:t.pageIndex,pageSize:t.pageSize},t.loading=!0,n.next=6,l.a.trace.getOnlineTraceBills(a);case 6:r=n.sent,t.tableData=r.list,t.total=r.reultAllCount,n.next=14;break;case 11:n.prev=11,n.t0=n.catch(1),t.$Message.error(n.t0.message);case 14:return n.prev=14,t.loading=!1,n.finish(14);case 17:case"end":return n.stop()}},n,t,[[1,11,14,17]])}))()},dateChange:function(e){this.daterange=e}}},p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"ui-toolbar"},[n("span",[e._v("时间段：")]),e._v(" "),n("DatePicker",{staticStyle:{width:"200px"},attrs:{options:e.options,type:"daterange",placement:"bottom-start",placeholder:"选择日期"},on:{"on-change":e.dateChange}}),e._v(" "),n("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:e.search}},[e._v("搜索")])],1),e._v(" "),n("Table",{attrs:{stripe:"",columns:e.columns,data:e.tableData,loading:e.loading}}),e._v(" "),n("appPage",{attrs:{total:e.total,pageIndex:e.pageIndex,pageSize:e.pageSize},on:{pageChange:e.getOnlineTraceBills}})],1)},g=[],h={render:p,staticRenderFns:g},f=h,v=n("C7Lr"),w=a,k=v(d,f,!1,w,"data-v-78978bf8",null);t.default=k.exports}});